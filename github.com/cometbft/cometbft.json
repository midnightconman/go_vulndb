[{"schema_version":"1.3.1","id":"GO-2023-1882","modified":"2023-07-06T20:13:13Z","published":"2023-07-06T20:13:13Z","aliases":["CVE-2023-34450","GHSA-mvj3-qrqh-cjvr"],"summary":"Deadlock in github.com/cometbft/cometbft/consensus","details":"An internal modification to the way PeerState is serialized to JSON introduced a deadlock when the new function MarshalJSON is called.\n\nThis function can be called in two ways. The first is via logs, by setting the consensus logging module to \"debug\" level (which should not happen in production), and setting the log output format to JSON. The second is via RPC dump_consensus_state.","affected":[{"package":{"name":"github.com/cometbft/cometbft","ecosystem":"Go"},"ranges":[{"type":"SEMVER","events":[{"introduced":"0.37.1"},{"fixed":"0.37.2"}]}],"ecosystem_specific":{"imports":[{"path":"github.com/cometbft/cometbft/consensus","symbols":["PeerState.MarshalJSON"]}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/cometbft/cometbft/security/advisories/GHSA-mvj3-qrqh-cjvr"},{"type":"FIX","url":"https://github.com/cometbft/cometbft/pull/524"},{"type":"FIX","url":"https://github.com/cometbft/cometbft/pull/863"},{"type":"FIX","url":"https://github.com/cometbft/cometbft/pull/865"}],"database_specific":{"url":"https://pkg.go.dev/vuln/GO-2023-1882"}},{"schema_version":"1.3.1","id":"GO-2023-1883","modified":"2023-07-13T22:19:53Z","published":"2023-07-13T22:19:53Z","aliases":["CVE-2023-34451","GHSA-w24w-wp77-qffm"],"summary":"Denial of service via OOM in github.com/cometbft/cometbft","details":"A bug in the CometBFT middleware causes the mempool's two data structures to fall out of sync. This can lead to duplicate transactions that cannot be removed, even after they are committed in a block. The only way to remove the transaction is to restart the node. This can be exploited by an attacker to bring down a node by repeatedly submitting duplicate transactions.","affected":[{"package":{"name":"github.com/cometbft/cometbft","ecosystem":"Go"},"ranges":[{"type":"SEMVER","events":[{"introduced":"0"},{"fixed":"0.37.2"}]}],"ecosystem_specific":{"imports":[{"path":"github.com/cometbft/cometbft/mempool/v0","symbols":["CListMempool.CheckTx","CListMempool.resCbFirstTime","Reactor.ReceiveEnvelope"]}]}}],"references":[{"type":"ADVISORY","url":"https://github.com/cometbft/cometbft/security/advisories/GHSA-w24w-wp77-qffm"},{"type":"FIX","url":"https://github.com/cometbft/cometbft/pull/890"},{"type":"FIX","url":"https://github.com/tendermint/tendermint/pull/2778"}],"database_specific":{"url":"https://pkg.go.dev/vuln/GO-2023-1883"}}]